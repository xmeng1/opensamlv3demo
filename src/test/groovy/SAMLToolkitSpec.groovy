import org.opensaml.saml.common.SAMLObject
import spock.lang.Specification


/**
 * User:    Xin Meng
 * Date:    07/05/17
 * Project: Default (Template) Project
 */
class SAMLToolkitSpec extends Specification {
    def "SAML request convert" (){
        given: "SAML request base 64 format string"
        String samlRequestBase64Str = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48c2FtbHA6QXV0aG5SZXF1ZXN0IHhtbG5zOnNhbWxwPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6cHJvdG9jb2wiIEFzc2VydGlvbkNvbnN1bWVyU2VydmljZVVSTD0iaHR0cHM6Ly9kZWVwbmV0LWRldi1lZC5teS5zYWxlc2ZvcmNlLmNvbT9zbz0wMEQwWTAwMDAwMWY3S2oiIERlc3RpbmF0aW9uPSJodHRwczovL2RlZXBuZXQtZGV2Lm9uZWxvZ2luLmNvbS90cnVzdC9zYW1sMi9odHRwLXBvc3Qvc3NvLzYzMTQzMiIgSUQ9Il8yQ0FBQUFWeDFQZnZlTUU4d01Ga3dNREF3TURBMFF6a3pBQUFBemplTm1XSjRGckl4d3Z0RDdCYzdla1hJR25obFBoTkVvMmpvdkxPbmV2aExTOUdvVk50eTdkdFUtdmRJeHlYaWJJMXNFMnh1RFNmSW41bVlTODQ1b3pPY2lGaDFadi0wQU5teUxHZHZwOFZ0c2pkWWtuLWxSay01TlY0YXNjN3FlY0t6b3V5ME5RM29IM2FfdWEtZk05d04zSGNxN0QzVlZFbVNNZGctOWhPSVpvZWFQSmtETUQwQzVIbm1zZUkySjZZclpXNmlsb0pmc2FkUXU2eC1yN25sTkxzMUREdXNqUFo2RXN5aWRjUnM0TTYtcE5nNTRDc0FONnE3VDNiQzR3IiBJc3N1ZUluc3RhbnQ9IjIwMTctMDUtMDdUMjI6MzM6NDQuNDE4WiIgUHJvdG9jb2xCaW5kaW5nPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YmluZGluZ3M6SFRUUC1QT1NUIiBWZXJzaW9uPSIyLjAiPjxzYW1sOklzc3VlciB4bWxuczpzYW1sPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIj5odHRwczovL3NhbWwuc2FsZXNmb3JjZS5jb208L3NhbWw6SXNzdWVyPjxkczpTaWduYXR1cmUgeG1sbnM6ZHM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiPgo8ZHM6U2lnbmVkSW5mbz4KPGRzOkNhbm9uaWNhbGl6YXRpb25NZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzEwL3htbC1leGMtYzE0biMiLz4KPGRzOlNpZ25hdHVyZU1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNyc2Etc2hhMSIvPgo8ZHM6UmVmZXJlbmNlIFVSST0iI18yQ0FBQUFWeDFQZnZlTUU4d01Ga3dNREF3TURBMFF6a3pBQUFBemplTm1XSjRGckl4d3Z0RDdCYzdla1hJR25obFBoTkVvMmpvdkxPbmV2aExTOUdvVk50eTdkdFUtdmRJeHlYaWJJMXNFMnh1RFNmSW41bVlTODQ1b3pPY2lGaDFadi0wQU5teUxHZHZwOFZ0c2pkWWtuLWxSay01TlY0YXNjN3FlY0t6b3V5ME5RM29IM2FfdWEtZk05d04zSGNxN0QzVlZFbVNNZGctOWhPSVpvZWFQSmtETUQwQzVIbm1zZUkySjZZclpXNmlsb0pmc2FkUXU2eC1yN25sTkxzMUREdXNqUFo2RXN5aWRjUnM0TTYtcE5nNTRDc0FONnE3VDNiQzR3Ij4KPGRzOlRyYW5zZm9ybXM+CjxkczpUcmFuc2Zvcm0gQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjZW52ZWxvcGVkLXNpZ25hdHVyZSIvPgo8ZHM6VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIj48ZWM6SW5jbHVzaXZlTmFtZXNwYWNlcyB4bWxuczplYz0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIiBQcmVmaXhMaXN0PSJkcyBzYW1sIHNhbWxwIi8+PC9kczpUcmFuc2Zvcm0+CjwvZHM6VHJhbnNmb3Jtcz4KPGRzOkRpZ2VzdE1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNzaGExIi8+CjxkczpEaWdlc3RWYWx1ZT5XdE5lUG9GRXVHdmFuS3VuT3RheXQrS0l4Rms9PC9kczpEaWdlc3RWYWx1ZT4KPC9kczpSZWZlcmVuY2U+CjwvZHM6U2lnbmVkSW5mbz4KPGRzOlNpZ25hdHVyZVZhbHVlPgprZGVyWW4waWJ5U2dBWHBIaXIzZW1kb04weG5ENDZDWDNVN00rcUkvdXVZUzdGUGdKTDdOR3FYQzEzeXp3U1V1OVhIa29oSEJZbnhHCmdTdFJHcVByTW02NUV3SDA1dkllYkNkbHJLVjNWS3dUSmZSUDdSSWxaMGY3cU15U1h3alpuQ2xrSUJISWQyNUl5d0xPVXZ5VkhSazcKUmtPWnFMZGdqOVNINU14MUpkaVozbGh4ZEdLcGREKzdnY2pnUUtIWEIxQytWb0Rmd2E0YkNyL1BUNDhoVjIyQmJBeTNHdDQ5Q3dqSQpJMHFXKzFYcDJWbjdJZWdQaUg0MlhNN3IvL3dJa0FDcUxTb1ZtMUlVbWZkYW5CbTFPRDJKVXlHVllPTTBpeWZObllxL1FHTXREZUE0CmxPZTNTQk91MXBheWpyWUIwMFN1QlRoNTJ1MzJFWEswSjIwQmhRPT0KPC9kczpTaWduYXR1cmVWYWx1ZT4KPGRzOktleUluZm8+PGRzOlg1MDlEYXRhPjxkczpYNTA5Q2VydGlmaWNhdGU+TUlJRXJEQ0NBNVNnQXdJQkFnSU9BVnVMZDFGakFBQUFBQzRQN0trd0RRWUpLb1pJaHZjTkFRRUxCUUF3Z1pBeEtEQW1CZ05WQkFNTQpIMU5sYkdaVGFXZHVaV1JEWlhKMFh6SXdRWEJ5TWpBeE4xOHhNekExTURReEdEQVdCZ05WQkFzTUR6QXdSREJaTURBd01EQXhaamRMCmFqRVhNQlVHQTFVRUNnd09VMkZzWlhObWIzSmpaUzVqYjIweEZqQVVCZ05WQkFjTURWTmhiaUJHY21GdVkybHpZMjh4Q3pBSkJnTlYKQkFnTUFrTkJNUXd3Q2dZRFZRUUdFd05WVTBFd0hoY05NVGN3TkRJd01UTXdOVEEwV2hjTk1UZ3dOREl3TVRJd01EQXdXakNCa0RFbwpNQ1lHQTFVRUF3d2ZVMlZzWmxOcFoyNWxaRU5sY25SZk1qQkJjSEl5TURFM1h6RXpNRFV3TkRFWU1CWUdBMVVFQ3d3UE1EQkVNRmt3Ck1EQXdNREZtTjB0cU1SY3dGUVlEVlFRS0RBNVRZV3hsYzJadmNtTmxMbU52YlRFV01CUUdBMVVFQnd3TlUyRnVJRVp5WVc1amFYTmoKYnpFTE1Ba0dBMVVFQ0F3Q1EwRXhEREFLQmdOVkJBWVRBMVZUUVRDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQwpnZ0VCQUtnOCtuNGgyNXpuNzdlVDhNSncvNXc3UW1aRmhVTFlMUkJlZ0pqS2x1M2tHUGxOVHR1dC9CNElFQVdkUHVacnFPV0ZHNWt3CnY3NnVJNXgzNThZSmpteXdJODlEQ1dMWXJpVk9BV3dub0VDdENJRDF0OVdJNEVCQmZ0VzhaN3RQTGovSEtqNzZCMENTaXVDVGY4Yk0KaDJrc1NYWWhCVWlMRThjbFlxd2M2Tm03WFBsYTJRa0FJOEJ2TWFiRGpaS2JPanFaWUFrOFl6dENOVUEzTGJESmhCMDVCTE5DSEFpWgo3Qm0yK005cUtkYXZUQW8rd3VlbnZTdlJEV1c2dFdxRUdnV2ZhWTZlaERnazlzOHhFeXl4VldWT0loaDFhczVUNjNnQ25nU1ZrOHNhCmRqWHF0YTIxcElHa050WGN3UTBFUTFjUTFXT2NQQU16RWxaa1JWQm9JNDBDQXdFQUFhT0NBUUF3Z2Ywd0hRWURWUjBPQkJZRUZKMzgKd0QwKzQvWnNVVElCb0VydEM1YnNhS3BXTUE4R0ExVWRFd0VCL3dRRk1BTUJBZjh3Z2NvR0ExVWRJd1NCd2pDQnY0QVVuZnpBUFQ3ago5bXhSTWdHZ1N1MExsdXhvcWxhaGdaYWtnWk13Z1pBeEtEQW1CZ05WQkFNTUgxTmxiR1pUYVdkdVpXUkRaWEowWHpJd1FYQnlNakF4Ck4xOHhNekExTURReEdEQVdCZ05WQkFzTUR6QXdSREJaTURBd01EQXhaamRMYWpFWE1CVUdBMVVFQ2d3T1UyRnNaWE5tYjNKalpTNWoKYjIweEZqQVVCZ05WQkFjTURWTmhiaUJHY21GdVkybHpZMjh4Q3pBSkJnTlZCQWdNQWtOQk1Rd3dDZ1lEVlFRR0V3TlZVMEdDRGdGYgppM2RSWXdBQUFBQXVEK3lwTUEwR0NTcUdTSWIzRFFFQkN3VUFBNElCQVFCdXpoR05sUDNEMDVOQzNRQS9nQ3VKUEovaDFYOVowTmdzCm5KdWErZm9XbFR4LzhBc2FWVDRzZGpJYkFHQ2dSL0JodnFJOUNQbFo4K09XajZwUi9mbVpUcjMrL3FGVVk2UnBYWG15ODBmWWJ3QncKWWl1NDFyeWJmMXEzV0JHZkMvK1NUdC9vcEZEQXZ0NEJEclU0c3VHQjZlaXZRb1lCN2ZyTGpWcGtTT2xrVDFKMmdQQWIwK0M1TEtoawpjcFBTaEpxVDkwb2VTanhLNk9sNExKbjZHaVYybHJVQUlzSCt3aGhzTmIrc25NWWFKTG50WEltekl6Tkp1eGRFWXR4SUxxc1FvRDhDCkN5NTdqZlp6ZHRMNDJJdTdsUml3SjRLNnZJUEV3a2l4OVNZZEpPZVRIZ21vWnVEN0lVOE5MWHB0UTNPY3M4UWV0T0ErK2R1Z1Y5ZmUKdHkxMDwvZHM6WDUwOUNlcnRpZmljYXRlPjwvZHM6WDUwOURhdGE+PC9kczpLZXlJbmZvPjwvZHM6U2lnbmF0dXJlPjwvc2FtbHA6QXV0aG5SZXF1ZXN0Pg=="

        when: "convert the base 64 saml request string to SAMLObject"
        SAMLObject samlObject = SAMLToolkit.convertBase64ToSaml(samlRequestBase64Str)

        then: "the should be right"
        println(samlObject.toString())
        println(samlObject.DOM.toString())
    }

}